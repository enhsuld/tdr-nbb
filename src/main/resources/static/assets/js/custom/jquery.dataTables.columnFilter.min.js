!function(e){e.fn.columnFilter=function(t){function n(e,t,n,a,r){if(void 0===t)return new Array;void 0===n&&(n=!0),void 0===a&&(a=!0),void 0===r&&(r=!0);var l;l=1==a?e.aiDisplay:e.aiDisplayMaster;for(var i=new Array,s=0,o=l.length;s<o;s++){var c=l[s],u=x.fnGetData(c),f=u[t];1==r&&0==f.length||(1==n&&jQuery.inArray(f,i)>-1||i.push(f))}return i.sort()}function a(e){return y.bUseColVis?e:x.fnSettings().oApi._fnVisibleToColumnIndex(x.fnSettings(),e)}function r(t,n,r,l,i,s){var o="text_filter form-control";l&&(o="number_filter form-control"),g=g.replace(/(^\s*)|(\s*$)/g,"");var c=t.fnSettings().aoPreSearchCols[p].sSearch,u="search_init ",f=g;""!=c&&"^"!=c&&(f=l&&"^"==c.charAt(0)?c.substr(1):c,u="");var d=e('<input type="text" class="md-input '+u+o+'" value="'+f+'" rel="'+p+'" md-input />');void 0!=s&&-1!=s&&d.attr("maxlength",s),v.html(d),l?v.wrapInner('<span class="filter_column filter_number" />'):v.wrapInner('<span class="filter_column filter_text" />'),h[p]=g;var m=p;l&&!t.fnSettings().oFeatures.bServerSide?d.keyup(function(){t.fnFilter("^"+this.value,a(m),!0,!1),S()}):d.keyup(function(){if(t.fnSettings().oFeatures.bServerSide&&0!=i){var l=(t.fnSettings().aoPreSearchCols[m].sSearch,e(this).data("dt-iLastFilterLength"));void 0===l&&(l=0);var s=this.value.length;if(Math.abs(s-l)<i)return;e(this).data("dt-iLastFilterLength",s)}t.fnFilter(this.value,a(m),n,r),S()}),d.focus(function(){e(this).hasClass("search_init")&&(e(this).removeClass("search_init"),this.value="")}),d.blur(function(){""==this.value&&(e(this).addClass("search_init"),this.value=h[m])})}function l(t){v.html(d(0));var n=t.attr("id")+"_range_from_"+p,r=e('<input type="text" class="number_range_filter form-control" id="'+n+'" rel="'+p+'"/>');v.append(r),v.append(d(1));var l=t.attr("id")+"_range_to_"+p,i=e('<input type="text" class="number_range_filter form-control" id="'+l+'" rel="'+p+'"/>');v.append(i),v.append(d(2)),v.wrapInner('<span class="filter_column filter_number_range form-control" />');var s=p;_.push(p),t.dataTableExt.afnFiltering.push(function(e,r,i){if(t.attr("id")!=e.sTableId)return!0;if(null==document.getElementById(n))return!0;var o=1*document.getElementById(n).value,c=1*document.getElementById(l).value,u="-"==r[a(s)]?0:1*r[a(s)];return""==o&&""==c||(""==o&&u<=c||(o<=u&&""==c||o<=u&&u<=c))}),e("#"+n+",#"+l,v).keyup(function(){var e=1*document.getElementById(n).value,a=1*document.getElementById(l).value;0!=e&&0!=a&&e>a||(t.fnDraw(),S())})}function i(t){var n=m.split(/[}{]/);v.html("");var r=t.attr("id")+"_range_from_"+p,l=e('<input type="text" class="date_range_filter form-control" id="'+r+'" rel="'+p+'"/>');l.datepicker();var i=t.attr("id")+"_range_to_"+p,s=e('<input type="text" class="date_range_filter form-control" id="'+i+'" rel="'+p+'"/>');for(ti=0;ti<n.length;ti++)n[ti]==y.sDateFromToken?v.append(l):n[ti]==y.sDateToToken?v.append(s):v.append(n[ti]);v.wrapInner('<span class="filter_column filter_date_range" />'),s.datepicker();var o=p;_.push(p),t.dataTableExt.afnFiltering.push(function(n,r,i){if(t.attr("id")!=n.sTableId)return!0;var c=l.datepicker("getDate"),u=s.datepicker("getDate");if(null==c&&null==u)return!0;var f=null;try{if(null==r[a(o)]||""==r[a(o)])return!1;f=e.datepicker.parseDate(e.datepicker.regional[""].dateFormat,r[a(o)])}catch(e){return!1}return null!=f&&(null==c&&f<=u||(c<=f&&null==u||c<=f&&f<=u))}),e("#"+r+",#"+i,v).change(function(){t.fnDraw(),S()})}function s(t,a,r,l,i,s,o,u){null==a&&(a=n(t.fnSettings(),r,!0,!1,!0));var f=r,d=t.fnSettings().aoPreSearchCols[p].sSearch;null!=d&&""!=d||(d=o);var h='<select class="search_init select_filter form-control" rel="'+p+'"><option value="" class="search_init">'+i+"</option>";u&&(h='<select class="search_init select_filter form-control" rel="'+p+'" multiple>');var g=0,v=a.length;for(g=0;g<v;g++)if("object"!=typeof a[g]){var m="";escape(a[g])!=d&&escape(a[g])!=escape(d)||(m="selected "),h+="<option "+m+' value="'+escape(a[g])+'">'+a[g]+"</option>"}else{var m="";s?(a[g].value==d&&(m="selected "),h+="<option "+m+'value="'+a[g].value+'">'+a[g].label+"</option>"):(escape(a[g].value)==d&&(m="selected "),h+="<option "+m+'value="'+escape(a[g].value)+'">'+a[g].label+"</option>")}var b=e(h+"</select>");l.html(b),l.wrapInner('<span class="filter_column filter_select" />'),u?b.change(function(){""!=e(this).val()?e(this).removeClass("search_init"):e(this).addClass("search_init");var n=e(this).val(),a=[];if(null==n||n==[])var r="^(.*)$";else{e.each(n,function(e,t){a.push(c(t))});var r="^("+a.join("|")+")$"}t.fnFilter(r,f,!0,!1)}):(b.change(function(){""!=e(this).val()?e(this).removeClass("search_init"):e(this).addClass("search_init"),s?t.fnFilter(e(this).val(),r,s):t.fnFilter(unescape(e(this).val()),r),S()}),null!=d&&""!=d&&t.fnFilter(unescape(d),r))}function o(e,t,n,r,l){var i=e.fnSettings();null!=t&&"function"!=typeof t||""==i.sAjaxSource||i.oFeatures.bServerSide||i.aoDrawCallback.push({fn:function(i,o,c){return function(u){if(2==u.iDraw&&null!=u.sAjaxSource&&""!=u.sAjaxSource&&!u.oFeatures.bServerSide)return s(e,t&&t(u.aoData,u),a(i),o,c,n,r,l)}}(p,v,g),sName:"column_filter_"+p}),s(e,"function"==typeof t?null:t,a(p),v,g,n,r,l)}function c(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function u(t){var n,a=p,r='<div class="dropdown select_filter form-control"><a class="dropdown-toggle" data-toggle="dropdown" href="#">'+g+'<b class="caret"></b></a><ul class="dropdown-menu" role="menu"><li data-value=""><a>Show All</a></li>',l=t.length;for(n=0;n<l;n++)r+='<li data-value="'+t[n]+'"><a>'+t[n]+"</a></li>";var i=e(r+"</ul></div>");v.html(i),v.wrapInner('<span class="filterColumn filter_select" />'),i.find("li").click(function(){x.fnFilter(e(this).data("value"),a)})}function f(t,a){null==a&&(a=n(t.fnSettings(),p,!0,!0,!0));var r,l=p,i="",s=a.length,o=g.replace("%","Perc").replace("&","AND").replace("$","DOL").replace("Â£","STERL").replace("@","AT").replace(/\s/g,"_");o=o.replace(/[^a-zA-Z 0-9]+/g,"");var c=g;null==y.sFilterButtonText&&void 0==y.sFilterButtonText||(c=y.sFilterButtonText);var u=Math.floor(s/12);s%12>0&&(u+=1);var f=100/u-2,d=10*u;1==u&&(f=20);var h='<div style="float:left; min-width: '+f+'%; " >',m=t.attr("id")+o,b="chkBtnOpen"+m,_=m+"-flt-toggle";for(i+='<button id="'+b+'" class="checkbox_filter btn btn-default" > '+c+"</button>",i+='<div id="'+_+'" title="'+g+'" rel="'+p+'" class="toggle-check ui-widget-content ui-corner-all"  style="width: '+d+'%; " >',i+=h,r=0;r<s;r++){r%12==0&&0!=r&&(i+="</div>"+h);var x=a[r],k=a[r];"object"==typeof a[r]&&(x=a[r].label,k=a[r].value),i+='<input class="search_init checkbox_filter btn btn-default" type="checkbox" id= "'+m+"_cb_"+k+'" name= "'+o+'" value="'+k+'" >'+x+"<br/>";var F=e(i);v.html(F),v.wrapInner('<span class="filter_column filter_checkbox" />'),F.change(function(){var n="",a="|",r=e('input:checkbox[name="'+o+'"]:checked').size();e('input:checkbox[name="'+o+'"]:checked').each(function(t){(0==t&&1==r||0!=t&&t==r-1)&&(a=""),n=n.replace(/^\s+|\s+$/g,""),n=n+e(this).val()+a,a="|"}),""!=n?e('input:checkbox[name="'+o+'"]').removeClass("search_init"):e('input:checkbox[name="'+o+'"]').addClass("search_init"),t.fnFilter(n,l,!0,!1),S()})}e("#"+b).button(),e("#"+_).dialog({autoOpen:!1,hide:"blind",buttons:[{text:"Reset",click:function(){return e('input:checkbox[name="'+o+'"]:checked').each(function(t){e(this).attr("checked",!1),e(this).addClass("search_init")}),t.fnFilter("",l,!0,!1),S(),!1}},{text:"Close",click:function(){e(this).dialog("close")}}]}),e("#"+b).click(function(){e("#"+_).dialog("open");var t=e(this);return e("#"+_).dialog("widget").position({my:"top",at:"bottom",of:t}),!1});var w=S;S=function(){var t=e("#"+b);e("#"+_).dialog("widget").position({my:"top",at:"bottom",of:t}),w()}}function d(e){switch(e){case 0:return m.substring(0,m.indexOf("{from}"));case 1:return m.substring(m.indexOf("{from}")+6,m.indexOf("{to}"));default:return m.substring(m.indexOf("{to}")+4)}}var h,p,g,v,m="From {from} to {to}",b=new Array,_=new Array,S=function(){},x=this,F={sPlaceHolder:"foot",sRangeSeparator:"~",iFilteringDelay:500,aoColumns:null,sRangeFormat:"From {from} to {to}",sDateFromToken:"from",sDateToToken:"to"},y=e.extend(F,t);return this.each(function(){if(x.fnSettings().oFeatures.bFilter){h=new Array;var t=x.fnSettings().aoFooter[0];x.fnSettings().nTFoot;if("head:after"==y.sPlaceHolder){var n=e("tr:first",x.fnSettings().nTHead).detach();x.fnSettings().bSortCellsTop?(n.prependTo(e(x.fnSettings().nTHead)),t=x.fnSettings().aoHeader[1]):(n.appendTo(e(x.fnSettings().nTHead)),t=x.fnSettings().aoHeader[0]),"tr:last",x.fnSettings().nTHead}else if("head:before"==y.sPlaceHolder){if(x.fnSettings().bSortCellsTop){var n=e("tr:first",x.fnSettings().nTHead).detach();n.appendTo(e(x.fnSettings().nTHead)),t=x.fnSettings().aoHeader[1]}else t=x.fnSettings().aoHeader[0];"tr:first",x.fnSettings().nTHead}for(e(t).each(function(t){p=t;var n={type:"text",bRegex:!1,bSmart:!0,iMaxLenght:-1,iFilterLength:0};if(null!=y.aoColumns){if(y.aoColumns.length<p||null==y.aoColumns[p])return;n=y.aoColumns[p]}if(g=e(e(this)[0].cell).text(),null==n.sSelector?v=e(e(this)[0].cell):(v=e(n.sSelector),0==v.length&&(v=e(e(this)[0].cell))),null!=n)switch(m=null!=n.sRangeFormat?n.sRangeFormat:y.sRangeFormat,n.type){case"null":break;case"number":r(x,!0,!1,!0,n.iFilterLength,n.iMaxLenght);break;case"select":1!=n.bRegex&&(n.bRegex=!1),o(x,n.values,n.bRegex,n.selected,n.multiple);break;case"number-range":l(x);break;case"date-range":i(x);break;case"checkbox":f(x,n.values);break;case"twitter-dropdown":case"dropdown":u(n.values);break;case"text":default:bRegex=null!=n.bRegex&&n.bRegex,bSmart=null!=n.bSmart&&n.bSmart,r(x,bRegex,bSmart,!1,n.iFilterLength,n.iMaxLenght)}}),j=0;j<_.length;j++){var a=function(){var t=x.attr("id");return e("#"+t+"_range_from_"+_[j]).val()+y.sRangeSeparator+e("#"+t+"_range_to_"+_[j]).val()};b.push(a)}if(x.fnSettings().oFeatures.bServerSide){var s=x.fnSettings().fnServerData;x.fnSettings().fnServerData=function(t,n,a){for(j=0;j<_.length;j++){var r=_[j];for(k=0;k<n.length;k++)n[k].name=="sSearch_"+r&&(n[k].value=b[j]())}if(n.push({name:"sRangeSeparator",value:y.sRangeSeparator}),null!=s)try{s(t,n,a,x.fnSettings())}catch(e){s(t,n,a)}else e.getJSON(t,n,function(e){a(e)})}}}})}}(jQuery);